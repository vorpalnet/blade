<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="." default="build" name="vorpal-blade-shared-libraries">
    <import file="../libraries.xml" />

	<path id="EAR Libraries.libraryclasspath" />

	<path id="vorpal-blade-shared-libraries.classpath">
		<pathelement location="build/classes" />
		<path refid="Web App Libraries.libraryclasspath" />
		<path refid="EAR Libraries.libraryclasspath" />
		<path refid="WebLogic System Libraries.libraryclasspath" />
	</path>
	<target name="init">
		<mkdir dir="build" />
		<mkdir dir="build/classes" />

<!--		
		<copy includeemptydirs="false" todir="build/classes">
			<fileset dir="src/main/java">
				<exclude name="**/*.launch" />
				<exclude name="**/*.java" />
			</fileset>
		</copy>
		<mkdir dir=".apt_src" />
		<copy includeemptydirs="false" todir="build/classes">
			<fileset dir=".apt_src">
				<exclude name="**/*.launch" />
				<exclude name="**/*.java" />
			</fileset>
		</copy>
-->		
	</target>
	<target name="clean">
		<delete dir="build" />
	</target>

	<target name="clean-all" depends="clean" />

	<!-- target name="build" depends="init,build-project"  /-->

	<target name="build-project" depends="init" >
		<echo message="${ant.project.name}: ${ant.file}" />
	</target>
	
	
	<condition property="isWindows">
	    <os family="windows" />
	</condition>

	<condition property="isUnix">
	    <os family="unix" />
	</condition>

	<target name="build" depends="init, build-project, mvn_windows, mvn_unix"/>

	<target name="mvn_windows" if="isWindows">
	    <exec dir="." executable="cmd">
	        <arg line="/c mvn clean package" />
	    </exec>
		<copy file="build/${ant.project.name}.war" todir="${dist}" />
	</target>

	<target name="mvn_unix" if="isUnix">
	    <exec dir="." executable="sh">
	        <arg line="-c 'mvn clean package'" />
	    </exec>
		<copy file="build/${ant.project.name}.war" todir="${dist}" />
	</target>
	
	

	
	
	
	

	<target name="package" depends="init">

		<manifest file="build/MANIFEST.MF">
			<attribute name="Built-By" value="${user.name}" />
			<attribute name="Specification-Title" value="Vorpal:BLADE Framework" />
			<attribute name="Specification-Version" value="${specification}" />
			<attribute name="Specification-Vendor" value="VORPAL.ORG" />
			<attribute name="Implementation-Title" value="Vorpal:BLADE Framework Implementation" />
			<attribute name="Implementation-Version" value="${implementation}" />
			<attribute name="Implementation-Vendor" value="Vorpal Networks, LLC" />
			<attribute name="Extension-Name" value="vorpal-blade" />
		</manifest>

<!--		
		<fileset dir="../vorpal-blade-library-framework/build" id="vorpal-blade-library-framework">
			<filename name="vorpal-blade-library-framework.jar" />
		</fileset>
-->
		
		<war destfile="build/${ant.project.name}.war"
		     basedir="src/main/webapp"
		     needxmlfile="false"
		     manifest="build/MANIFEST.MF">
			<!--
			<lib refid="vorpal-blade-library-framework" />
			-->
			<classes dir="build/classes" />
		</war>

		<copy file="build/${ant.project.name}.war" todir="${dist}" />

	</target>
	
	<target name="build-javadocs" depends="">
		<!-- Do nothing. -->
    </target>

</project>
