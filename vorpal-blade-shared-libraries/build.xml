<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="." default="build" name="vorpal-blade-shared-libraries">
	<property environment="env" />


	<path id="EAR Libraries.libraryclasspath" />

	<path id="vorpal-blade-shared-libraries.classpath">
		<pathelement location="build/classes" />
		<path refid="Web App Libraries.libraryclasspath" />
		<path refid="EAR Libraries.libraryclasspath" />
		<path refid="WebLogic System Libraries.libraryclasspath" />
	</path>
	<target name="init">
		<mkdir dir="build/classes" />
		<copy includeemptydirs="false" todir="build/classes">
			<fileset dir="src/main/java">
				<exclude name="**/*.launch" />
				<exclude name="**/*.java" />
			</fileset>
		</copy>
		<mkdir dir=".apt_src" />
		<copy includeemptydirs="false" todir="build/classes">
			<fileset dir=".apt_src">
				<exclude name="**/*.launch" />
				<exclude name="**/*.java" />
			</fileset>
		</copy>
	</target>
	<target name="clean">
		<delete dir="build" />
	</target>

	<target name="clean-all" depends="clean,init" />

	<target depends="init,build-project,package" name="build" />
	<target depends="init" name="build-project">
		<echo message="${ant.project.name}: ${ant.file}" />
		<javac debug="true"
		       debuglevel="${debuglevel}"
		       destdir="build/classes"
		       includeantruntime="false"
		       source="${source}"
		       target="${target}">
			<src path="src/main/java" />

			<!--
			<src path=".apt_src" />
			-->

			<classpath refid="vorpal-blade-shared-libraries.classpath" />
		</javac>
	</target>

	<target name="package" depends="init">

		<manifest file="build/MANIFEST.MF">
			<attribute name="Built-By" value="${user.name}" />
			<attribute name="Specification-Title" value="Vorpal:BLADE Framework" />
			<attribute name="Specification-Version" value="${specification}" />
			<attribute name="Specification-Vendor" value="VORPAL.ORG" />
			<attribute name="Implementation-Title" value="Vorpal:BLADE Framework Implementation" />
			<attribute name="Implementation-Version" value="${implementation}" />
			<attribute name="Implementation-Vendor" value="Vorpal Networks, LLC" />
			<attribute name="Extension-Name" value="vorpal-blade" />
		</manifest>

		<fileset dir="../vorpal-blade-library-framework/build" id="vorpal-blade-library-framework">
			<filename name="vorpal-blade-library-framework-${implementation}.jar" />
		</fileset>

		<war destfile="build/${ant.project.name}-${implementation}.war"
		     basedir="src/main/webapp"
		     needxmlfile="false"
		     manifest="build/MANIFEST.MF">
			<lib refid="vorpal-blade-library-framework" />
			<classes dir="build/classes" />
		</war>

		<copy file="build/${ant.project.name}-${implementation}.war" todir="${dist}" />

	</target>

</project>
